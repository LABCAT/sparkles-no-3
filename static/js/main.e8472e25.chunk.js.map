{"version":3,"sources":["js/helpers/Globals.js","js/functions/PlayIcon.js","audio/sparkles-no-3.ogg","audio/sparkles-no-3.mid","js/P5SketchWithAudio.js","js/App.js","index.js"],"names":["window","p5","PlayIcon","id","className","xmlns","height","viewBox","width","d","fill","P5SketchWithAudio","sketchRef","useRef","Sketch","p","canvas","canvasWidth","innerWidth","canvasHeight","innerHeight","audioLoaded","player","PPQ","loadMidi","Midi","fromUrl","midi","then","result","console","log","noteSet1","tracks","notes","scheduleCueSet","document","getElementById","classList","add","remove","preload","song","loadSound","audio","onended","logCredits","noteSet","callbackName","poly","lastTicks","currentCue","i","length","note","ticks","time","addCue","numOfLoops","vx","Array","vy","x","y","ax","ay","vx2","vy2","x2","y2","ax2","ay2","touchX","touchY","hueOptions","hueRangeMin","random","hueRangeMax","magnetism","radius","gensoku","setup","createCanvas","noStroke","background","ellipseMode","RADIUS","colorMode","HSB","blendMode","ADD","setupParticles","draw","isPlaying","distance","dist","sokudo","r","map","g","b","ellipse","executeCueSet1","clear","hasStarted","mousePressed","pause","parseInt","currentTime","buffer","duration","reset","dataLayer","push","title","location","href","addClass","play","creditsLogged","stop","updateCanvasDimensions","resizeCanvas","attachEvent","addEventListener","useEffect","current","ref","App","ReactDOM","render","StrictMode"],"mappings":"oMAGAA,OAAOC,GAAKA,E,yBCHG,SAASC,IACpB,OACI,sBAAKC,GAAG,YAAYC,UAAU,WAAWC,MAAM,6BAA6BC,OAAO,KAAKC,QAAQ,YAAYC,MAAM,KAAlH,UACI,sBAAMC,EAAE,gBAAgBC,KAAK,SAC7B,sBAAMD,EAAE,2JCJL,UAA0B,0CCA1B,MAA0B,0CC8P1BE,EApPW,WACtB,IAAMC,EAAYC,mBAEZC,EAAS,SAAAC,GAEXA,EAAEC,OAAS,KAEXD,EAAEE,YAAcjB,OAAOkB,WAEvBH,EAAEI,aAAenB,OAAOoB,YAExBL,EAAEM,aAAc,EAEhBN,EAAEO,OAAS,KAEXP,EAAEQ,IAAM,MAERR,EAAES,SAAW,WACTC,OAAKC,QAAQC,GAAMC,MACf,SAASC,GACLC,QAAQC,IAAIF,GACZ,IAAMG,EAAWH,EAAOI,OAAO,GAAGC,MAClCnB,EAAEoB,eAAeH,EAAU,kBAC3BjB,EAAEM,aAAc,EAChBe,SAASC,eAAe,UAAUC,UAAUC,IAAI,qBAChDH,SAASC,eAAe,aAAaC,UAAUE,OAAO,gBAMlEzB,EAAE0B,QAAU,WACR1B,EAAE2B,KAAO3B,EAAE4B,UAAUC,EAAO7B,EAAES,UAC9BT,EAAE2B,KAAKG,QAAQ9B,EAAE+B,aAGrB/B,EAAEoB,eAAiB,SAACY,EAASC,GAGzB,IAH0D,IAAnBC,EAAkB,wDACrDC,GAAa,EACbC,EAAa,EACRC,EAAI,EAAGA,EAAIL,EAAQM,OAAQD,IAAK,CAC/B,IAAAE,EAAOP,EAAQK,GACfG,EAAgBD,EAAhBC,MAAOC,EAASF,EAATE,MACVD,IAAUL,GAAaD,KACtBK,EAAKH,WAAaA,EAClBpC,EAAE2B,KAAKe,OAAOD,EAAMzC,EAAEiC,GAAeM,GACrCJ,EAAYK,EACZJ,OAKZpC,EAAE2C,WAAa,KAEf3C,EAAE4C,GAAK,IAAIC,MAAM7C,EAAE2C,YACnB3C,EAAE8C,GAAK,IAAID,MAAM7C,EAAE2C,YACnB3C,EAAE+C,EAAI,IAAIF,MAAM7C,EAAE2C,YAClB3C,EAAEgD,EAAI,IAAIH,MAAM7C,EAAE2C,YAClB3C,EAAEiD,GAAK,IAAIJ,MAAM7C,EAAE2C,YACnB3C,EAAEkD,GAAK,IAAIL,MAAM7C,EAAE2C,YAEnB3C,EAAEmD,IAAM,IAAIN,MAAM7C,EAAE2C,YACpB3C,EAAEoD,IAAM,IAAIP,MAAM7C,EAAE2C,YACpB3C,EAAEqD,GAAK,IAAIR,MAAM7C,EAAE2C,YACnB3C,EAAEsD,GAAK,IAAIT,MAAM7C,EAAE2C,YACnB3C,EAAEuD,IAAM,IAAIV,MAAM7C,EAAE2C,YACpB3C,EAAEwD,IAAM,IAAIX,MAAM7C,EAAE2C,YAEpB3C,EAAEyD,OAAS,EACXzD,EAAE0D,OAAS,EACX1D,EAAE2D,WAAa,CAAC,EAAG,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAClE3D,EAAE4D,YAAc5D,EAAE6D,OAAO7D,EAAE2D,YAC3B3D,EAAE8D,YAAc9D,EAAE4D,YAAc,GAEhC5D,EAAE+D,UAAY,GAEd/D,EAAEgE,OAAS,IACXhE,EAAEiE,QAAU,IAEZjE,EAAEkE,MAAQ,WACNlE,EAAEC,OAASD,EAAEmE,aAAanE,EAAEE,YAAaF,EAAEI,cAC3CJ,EAAEoE,WACFpE,EAAEqE,WAAW,GACbrE,EAAEL,KAAK,GACPK,EAAEsE,YAAYtE,EAAEuE,QAChBvE,EAAEwE,UAAUxE,EAAEyE,KACdzE,EAAE0E,UAAU1E,EAAE2E,KACd3E,EAAE4E,kBAGN5E,EAAE4E,eAAiB,WACf,IAAI,IAAIvC,EAAG,EAAGA,EAAGrC,EAAE2C,WAAYN,IAC3BrC,EAAE+C,EAAEV,GAAKrC,EAAE6D,OAAO7D,EAAEP,OACpBO,EAAEgD,EAAEX,GAAKrC,EAAE6D,OAAO7D,EAAET,QACpBS,EAAE4C,GAAGP,GAAK,EACVrC,EAAE8C,GAAGT,GAAK,EACVrC,EAAEiD,GAAGZ,GAAK,EACVrC,EAAEkD,GAAGb,GAAK,GAIlBrC,EAAE6E,KAAO,WACL,GAAG7E,EAAEM,aAAeN,EAAE2B,KAAKmD,YAAY,CACnC9E,EAAEqE,WAAW,GACb,IAAI,IAAIhC,EAAE,EAAGA,EAAIrC,EAAE2C,WAAYN,IAAI,CAC/B,IAAM0C,EAAW/E,EAAEgF,KAAKhF,EAAEyD,OAAQzD,EAAE0D,OAAQ1D,EAAE+C,EAAEV,GAAIrC,EAAEgD,EAAEX,IAErD0C,EAAW,IACV/E,EAAEiD,GAAGZ,GAAKrC,EAAE+D,WAAa/D,EAAEyD,OAASzD,EAAE+C,EAAEV,KAAO0C,EAAWA,GAC1D/E,EAAEkD,GAAGb,GAAKrC,EAAE+D,WAAa/D,EAAE0D,OAAS1D,EAAEgD,EAAEX,KAAO0C,EAAWA,IAE9D/E,EAAE4C,GAAGP,IAAMrC,EAAEiD,GAAGZ,GAChBrC,EAAE8C,GAAGT,IAAMrC,EAAEkD,GAAGb,GAEhBrC,EAAE4C,GAAGP,GAAKrC,EAAE4C,GAAGP,GAAKrC,EAAEiE,QACtBjE,EAAE8C,GAAGT,GAAKrC,EAAE8C,GAAGT,GAAKrC,EAAEiE,QAEtBjE,EAAE+C,EAAEV,IAAMrC,EAAE4C,GAAGP,GACfrC,EAAEgD,EAAEX,IAAMrC,EAAE8C,GAAGT,GAEf,IAAM4C,EAASjF,EAAEgF,KAAK,EAAG,EAAGhF,EAAE4C,GAAGP,GAAIrC,EAAE8C,GAAGT,IACpC6C,EAAIlF,EAAEmF,IAAIF,EAAQ,EAAG,EAAGjF,EAAE4D,YAAa5D,EAAE8D,aACzCsB,EAAIpF,EAAEmF,IAAIF,EAAQ,EAAG,EAAG,GAAI,KAC5BI,EAAIrF,EAAEmF,IAAIF,EAAQ,EAAG,EAAG,GAAI,KAClCjF,EAAEL,KAAKuF,EAAGE,EAAGC,EAAG,IAChBrF,EAAEsF,QAAQtF,EAAE+C,EAAEV,GAAIrC,EAAEgD,EAAEX,GAAIrC,EAAEgE,OAAQhE,EAAEgE,WAKlDhE,EAAEuF,eAAiB,SAAChD,GAChB,IAAQH,EAAeG,EAAfH,WACRrB,QAAQC,IAAIoB,GACTA,EAAa,GAAKA,EAAa,IAC9BpC,EAAEwF,QAENxF,EAAEyD,OAASzD,EAAE6D,OAAO,EAAG7D,EAAEP,OACzBO,EAAE0D,OAAS1D,EAAE6D,OAAO,EAAG7D,EAAET,QACzBS,EAAE4D,YAAc5D,EAAE6D,OAAO7D,EAAE2D,YAC3B3D,EAAE8D,YAAc9D,EAAE4D,YAAc,GAChC5D,EAAE+D,UAAY/D,EAAE6D,OAAO,GAAI,MAG/B7D,EAAEyF,YAAa,EAEfzF,EAAE0F,aAAe,WACV1F,EAAEM,cACGN,EAAE2B,KAAKmD,YACP9E,EAAE2B,KAAKgE,SAEHC,SAAS5F,EAAE2B,KAAKkE,gBAAkBD,SAAS5F,EAAE2B,KAAKmE,OAAOC,YACzD/F,EAAEgG,QAC8B,qBAArB/G,OAAOgH,WACdhH,OAAOgH,UAAUC,KACb,CACI,MAAS,iBACT,UAAa,CACT,MAAS7E,SAAS8E,MAClB,SAAYlH,OAAOmH,SAASC,KAC5B,OAAU,gBAM9BhF,SAASC,eAAe,aAAaC,UAAUC,IAAI,YACnDxB,EAAEC,OAAOqG,SAAS,WAClBtG,EAAE2B,KAAK4E,OACyB,qBAArBtH,OAAOgH,WAAmCjG,EAAEyF,aACnDxG,OAAOgH,UAAUC,KACb,CACI,MAAS,iBACT,UAAa,CACT,MAAS7E,SAAS8E,MAClB,SAAYlH,OAAOmH,SAASC,KAC5B,OAAU,mBAItBrG,EAAEyF,YAAa,MAM/BzF,EAAEwG,eAAgB,EAElBxG,EAAE+B,WAAa,YAEN/B,EAAEwG,eACHZ,SAAS5F,EAAE2B,KAAKkE,gBAAkBD,SAAS5F,EAAE2B,KAAKmE,OAAOC,YAEzD/F,EAAEwG,eAAgB,EACdzF,QAAQC,IACR,8BACA,KACA,4CAEJhB,EAAE2B,KAAK8E,SAIfzG,EAAEgG,MAAQ,aAIVhG,EAAE0G,uBAAyB,WACvB1G,EAAEE,YAAcjB,OAAOkB,WACvBH,EAAEI,aAAenB,OAAOoB,YACxBL,EAAEC,OAASD,EAAE2G,aAAa3G,EAAEE,YAAaF,EAAEI,eAG3CnB,OAAO2H,YACP3H,OAAO2H,YACH,YACA,WACI5G,EAAE0G,4BAILzH,OAAO4H,kBACZ5H,OAAO4H,iBACH,UACA,WACI7G,EAAE0G,4BAEN,IAYZ,OAJAI,qBAAU,WACN,IAAI5H,EAAGa,EAAQF,EAAUkH,WAC1B,IAGC,qBAAKC,IAAKnH,EAAV,SACI,cAACV,EAAD,OCjPG8H,MANf,WACE,OACE,cAAC,EAAD,KCCJC,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEF/F,SAASC,eAAe,W","file":"static/js/main.e8472e25.chunk.js","sourcesContent":["// p5.sound doesn't work correctly when p5 is not available in the global name space so we add it here\n// https://github.com/processing/p5.js-sound/issues/512\nimport * as p5 from \"p5\";\nwindow.p5 = p5;\n","export default function PlayIcon() {\n    return (\n        <svg id=\"play-icon\" className='fade-out' xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\">\n            <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n            <path d=\"M10 16.5l6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\" />\n        </svg>\n    )\n}\n","export default __webpack_public_path__ + \"static/media/sparkles-no-3.d95b7c9c.ogg\";","export default __webpack_public_path__ + \"static/media/sparkles-no-3.9566e745.mid\";","import React, { useRef, useEffect } from \"react\";\nimport \"./helpers/Globals\";\nimport \"p5/lib/addons/p5.sound\";\nimport * as p5 from \"p5\";\nimport { Midi } from '@tonejs/midi'\nimport PlayIcon from './functions/PlayIcon.js';\n\nimport audio from \"../audio/sparkles-no-3.ogg\";\nimport midi from \"../audio/sparkles-no-3.mid\";\n\nconst P5SketchWithAudio = () => {\n    const sketchRef = useRef();\n\n    const Sketch = p => {\n\n        p.canvas = null;\n\n        p.canvasWidth = window.innerWidth;\n\n        p.canvasHeight = window.innerHeight;\n\n        p.audioLoaded = false;\n\n        p.player = null;\n\n        p.PPQ = 3840 * 4;\n\n        p.loadMidi = () => {\n            Midi.fromUrl(midi).then(\n                function(result) {\n                    console.log(result);\n                    const noteSet1 = result.tracks[1].notes;\n                    p.scheduleCueSet(noteSet1, 'executeCueSet1');\n                    p.audioLoaded = true;\n                    document.getElementById(\"loader\").classList.add(\"loading--complete\");\n                    document.getElementById(\"play-icon\").classList.remove(\"fade-out\");\n                }\n            );\n            \n        }\n\n        p.preload = () => {\n            p.song = p.loadSound(audio, p.loadMidi);\n            p.song.onended(p.logCredits);\n        }\n\n        p.scheduleCueSet = (noteSet, callbackName, poly = false)  => {\n            let lastTicks = -1,\n                currentCue = 1;\n            for (let i = 0; i < noteSet.length; i++) {\n                const note = noteSet[i],\n                    { ticks, time } = note;\n                if(ticks !== lastTicks || poly){\n                    note.currentCue = currentCue;\n                    p.song.addCue(time, p[callbackName], note);\n                    lastTicks = ticks;\n                    currentCue++;\n                }\n            }\n        } \n\n        p.numOfLoops = 1688;\n\n        p.vx = new Array(p.numOfLoops);\n        p.vy = new Array(p.numOfLoops);\n        p.x = new Array(p.numOfLoops);\n        p.y = new Array(p.numOfLoops);\n        p.ax = new Array(p.numOfLoops);\n        p.ay = new Array(p.numOfLoops);\n        \n        p.vx2 = new Array(p.numOfLoops);\n        p.vy2 = new Array(p.numOfLoops);\n        p.x2 = new Array(p.numOfLoops);\n        p.y2 = new Array(p.numOfLoops);\n        p.ax2 = new Array(p.numOfLoops);\n        p.ay2 = new Array(p.numOfLoops);\n\n        p.touchX = 0;\n        p.touchY = 0;\n        p.hueOptions = [0, 30, 60, 80, 120, 150, 180, 210, 240, 270, 300, 330];\n        p.hueRangeMin = p.random(p.hueOptions);\n        p.hueRangeMax = p.hueRangeMin + 30;\n\n        p.magnetism = 88.0;\n        \n        p.radius = 1.5;\n        p.gensoku = 0.95; // principle\n\n        p.setup = () => {\n            p.canvas = p.createCanvas(p.canvasWidth, p.canvasHeight);\n            p.noStroke(); \n            p.background(0);\n            p.fill(0);\n            p.ellipseMode(p.RADIUS);\n            p.colorMode(p.HSB);\n            p.blendMode(p.ADD);\n            p.setupParticles();\n        }\n\n        p.setupParticles = () => {\n            for(var i =0; i< p.numOfLoops; i++){\n                p.x[i] = p.random(p.width);\n                p.y[i] = p.random(p.height);\n                p.vx[i] = 0;\n                p.vy[i] = 0;\n                p.ax[i] = 0;\n                p.ay[i] = 0;\n            }\n        }\n\n        p.draw = () => {\n            if(p.audioLoaded && p.song.isPlaying()){\n                p.background(0);\n                for(let i=0; i < p.numOfLoops; i++){\n                    const distance = p.dist(p.touchX, p.touchY, p.x[i], p.y[i]);\n\n                    if(distance > 3){\n                        p.ax[i] = p.magnetism * (p.touchX - p.x[i]) / (distance * distance); \n                        p.ay[i] = p.magnetism * (p.touchY - p.y[i]) / (distance * distance);\n                    }\n                    p.vx[i] += p.ax[i];\n                    p.vy[i] += p.ay[i];\n                    \n                    p.vx[i] = p.vx[i] * p.gensoku;\n                    p.vy[i] = p.vy[i] * p.gensoku;\n                    \n                    p.x[i] += p.vx[i]; \n                    p.y[i] += p.vy[i]; \n                    \n                    const sokudo = p.dist(0, 0, p.vx[i], p.vy[i]);\n                    const r = p.map(sokudo, 0, 5, p.hueRangeMin, p.hueRangeMax); \n                    const g = p.map(sokudo, 0, 5, 75, 100);\n                    const b = p.map(sokudo, 0, 5, 75, 100);\n                    p.fill(r, g, b, 0.1);\n                    p.ellipse(p.x[i], p.y[i], p.radius, p.radius);\n                }\n            }\n        }\n\n        p.executeCueSet1 = (note) => {\n            const { currentCue } = note;\n            console.log(currentCue);\n            if(currentCue % 2 && currentCue < 18) {\n                p.clear();\n            }\n            p.touchX = p.random(0, p.width);\n            p.touchY = p.random(0, p.height);\n            p.hueRangeMin = p.random(p.hueOptions);\n            p.hueRangeMax = p.hueRangeMin + 30;\n            p.magnetism = p.random(88, 444);\n        }\n\n        p.hasStarted = false;\n\n        p.mousePressed = () => {\n            if(p.audioLoaded){\n                if (p.song.isPlaying()) {\n                    p.song.pause();\n                } else {\n                    if (parseInt(p.song.currentTime()) >= parseInt(p.song.buffer.duration)) {\n                        p.reset();\n                        if (typeof window.dataLayer !== typeof undefined){\n                            window.dataLayer.push(\n                                { \n                                    'event': 'play-animation',\n                                    'animation': {\n                                        'title': document.title,\n                                        'location': window.location.href,\n                                        'action': 'replaying'\n                                    }\n                                }\n                            );\n                        }\n                    }\n                    document.getElementById(\"play-icon\").classList.add(\"fade-out\");\n                    p.canvas.addClass(\"fade-in\");\n                    p.song.play();\n                    if (typeof window.dataLayer !== typeof undefined && !p.hasStarted){\n                        window.dataLayer.push(\n                            { \n                                'event': 'play-animation',\n                                'animation': {\n                                    'title': document.title,\n                                    'location': window.location.href,\n                                    'action': 'start playing'\n                                }\n                            }\n                        );\n                        p.hasStarted = false\n                    }\n                }\n            }\n        }\n\n        p.creditsLogged = false;\n\n        p.logCredits = () => {\n            if (\n                !p.creditsLogged &&\n                parseInt(p.song.currentTime()) >= parseInt(p.song.buffer.duration)\n            ) {\n                p.creditsLogged = true;\n                    console.log(\n                    \"Music By: http://labcat.nz/\",\n                    \"\\n\",\n                    \"Animation By: https://github.com/LABCAT/\"\n                );\n                p.song.stop();\n            }\n        };\n\n        p.reset = () => {\n\n        }\n\n        p.updateCanvasDimensions = () => {\n            p.canvasWidth = window.innerWidth;\n            p.canvasHeight = window.innerHeight;\n            p.canvas = p.resizeCanvas(p.canvasWidth, p.canvasHeight);\n        }\n\n        if (window.attachEvent) {\n            window.attachEvent(\n                'onresize',\n                function () {\n                    p.updateCanvasDimensions();\n                }\n            );\n        }\n        else if (window.addEventListener) {\n            window.addEventListener(\n                'resize',\n                function () {\n                    p.updateCanvasDimensions();\n                },\n                true\n            );\n        }\n        else {\n            //The browser does not support Javascript event binding\n        }\n    };\n\n    useEffect(() => {\n        new p5(Sketch, sketchRef.current);\n    }, []);\n\n    return (\n        <div ref={sketchRef}>\n            <PlayIcon />\n        </div>\n    );\n};\n\nexport default P5SketchWithAudio;\n","import P5SketchWithAudio from './P5SketchWithAudio'\n\nfunction App() {\n  return (\n    <P5SketchWithAudio/>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './css/build.css';\nimport App from './js/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}